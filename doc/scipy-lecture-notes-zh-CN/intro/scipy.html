<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.5. Scipy : 高性能科学计算 &#8212; Scipy lecture notes</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2016.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Scipy lecture notes" href="../index.html" />
    <link rel="up" title="1. 基础教程" href="index.html" />
    <link rel="next" title="1.5.11.1. Maximum wind speed prediction at the Sprogø station" href="summary-exercises/stats-interpolate.html" />
    <link rel="prev" title="1.4. Matplotlib: 绘图" href="matplotlib/matplotlib.html" />
   
    <link rel="stylesheet"
	  href="http://yui.yahooapis.com/pure/0.6.0/base-min.css">

<script type="text/javascript">
$(function () {
    // Highlight the table of content as we scroll
    sections = {},
    i        = 0,
    url	 = document.URL.replace(/#.*$/, ""),
    current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();

	// Highlight the current section
	$('a.internal').parent().removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            };
	    if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
	    };
        }
	$('a.internal[href$="' + current_section + '"]').parent().addClass('active');
	$('a.internal[href$="' + current_section + '"]').parent().parent().parent().addClass('active');
	$('a.internal[href$="' + current_section + '"]').parent().parent().parent().parent().parent().addClass('active');
    });

});
</script>


  </head>
  <body role="document">
   <!-- Use the header to add javascript -->
    

    <script type="text/javascript">
    // Function to collapse the tip divs
    function collapse_tip_div(obj){
	// Update the representation on the tip div based on whether it
	// has the 'collapsed' css class or not: we only want to
	// collapse divs that are not already collapsed
	if($(obj).hasClass("collapsed")) {
	} else {
	    $(obj).find("p.summary").remove();
	    var content = $(obj).text();
	    var html = $(obj).html();

	    if(content.length > 40) {
		if ($.browser.msie) {
		    // We start at '3' to avoid 'tip', as IE
		    // does not count whitespace
		    var content = content.substr(3, 50);
		} else {
		    // We start at '5' to avoid 'tip '
		    var content = content.substr(5, 50);
		}
	    }
	    $(obj).html('<p class="summary"><img src="../_static/plus.png">' + content + '...</p>' + html);
	}
    }
    </script>

    <script type="text/javascript">
    $(function () {
	$(".tip")
	    .click(function(event){
		$(this).toggleClass("collapsed");
		// Change state of the global button
		$('div.related li.transparent').removeClass('transparent')
		$(this).find("p.summary").remove();
		if($(this).hasClass("collapsed")) {
		    var content = $(this).text();
		    var html = $(this).html();

		    if(content.length > 40) {
			if ($.browser.msie) {
			    // We start at '3' to avoid 'tip', as IE
			    // does not count whitespace
			    var content = content.substr(3, 50);
			} else {
			    // We start at '5' to avoid 'tip '
			    var content = content.substr(5, 50);
			}
		    }
		    $(this).html('<p class="summary"><img src="../_static/plus.png">' + content + '...</p>' + html);
		}
		if (event.target.tagName.toLowerCase() != "a") {
                   return true; //Makes links clickable
		}
	});
    });
    </script>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.5.11.1. Maximum wind speed prediction at the Sprogø station"
             accesskey="N">下一页</a></li>
        <li class="right" >
          <a href="matplotlib/matplotlib.html" title="1.4. Matplotlib: 绘图"
             accesskey="P">上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Scipy lecture notes</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">1. 基础教程</a> &#187;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>
    <li class="right edit_on_github"><a href="https://github.com/jayleicn/scipy-lecture-notes-zh-CN/edit/master/intro/scipy.rst">Edit
    <span class="tooltip">
	Improve this page:<br/>Translate/Improve it on Github.
    </span>
    </a>
    </li>

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="scipy">
<span id="id1"></span><h1>1.5. Scipy : 高性能科学计算<a class="headerlink" href="#scipy" title="永久链接至标题">¶</a></h1>
<p><strong>作者</strong>: <em>Adrien Chauve, Andre Espaze, Emmanuelle Gouillart, Gaël
Varoquaux, Ralf Gommers</em></p>
<p><strong>译者</strong>: <em>Jay Lei</em></p>
<div class="topic">
<p class="topic-title first">Scipy</p>
<p><code class="docutils literal"><span class="pre">scipy</span></code> 中有许多科学计算常见问题的工具，比如内置了图像处理，
优化，统计等等相关问题的子模块。</p>
<p>正如GSL库在C和C++中，或者相关工具箱在Matlab中的地位一样， <code class="docutils literal"><span class="pre">scipy</span></code> 是Python科学计算环境的核心。
它被设计为利用 <code class="docutils literal"><span class="pre">numpy</span></code> 数组进行高效的运行。从这个角度来讲，scipy和numpy是密不可分的。</p>
<p>在执行一段程序前，很有必要检查数据处理是否是已经用Scipy完成了。不专业的程序员或者科学家们经常
会去 <strong>重新造轮子</strong> 。 多数时候这并不是一件好事，相比于Scipy中优化过的程序，这些新的“轮子”通常
存在缺陷，未完全优化，以及可维护性差，不易分享等等问题。</p>
</div>
<div class="contents local topic" id="chapters-contents">
<p class="topic-title first">Chapters contents</p>
<ul class="simple">
<li><a class="reference internal" href="#scipy-io" id="id6">文件输入输出: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.io</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-special" id="id7">特殊函数: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-linalg" id="id8">线性代数操作: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-fftpack" id="id9">快速傅里叶变换: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-optimize" id="id10">优化和拟合: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-stats" id="id11">统计和随机数: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-interpolate" id="id12">插值计算: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></code></a></a></li>
<li><a class="reference internal" href="#numerical-integration-scipy-integrate" id="id13">Numerical integration: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-signal" id="id14">信号处理: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></code></a></a></li>
<li><a class="reference internal" href="#scipy-ndimage" id="id15">图像处理: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></code></a></a></li>
<li><a class="reference internal" href="#summary-exercises-on-scientific-computing" id="id16">Summary exercises on scientific computing</a></li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">这份教程的目的并不是提供一个数值计算的简介。因逐一列举式地去介绍scipy中的各个模块和
函数会显得十分无趣，我们将重点放在了介绍一些能够说明 <code class="docutils literal"><span class="pre">scipy</span></code> 在科学计算中的作用的
小例子。</p>
</div>
<p><code class="xref py py-mod docutils literal"><span class="pre">scipy</span></code> 由一些处理不同任务的子模块构成:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/cluster.html#module-scipy.cluster" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.cluster</span></code></a></td>
<td>矢量量化 / Kmeans</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/constants.html#module-scipy.constants" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.constants</span></code></a></td>
<td>数学，物理常量</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></code></a></td>
<td>傅里叶变换</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></code></a></td>
<td>Integration routines</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></code></a></td>
<td>插值计算</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.io</span></code></a></td>
<td>数据输入输出</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></code></a></td>
<td>线性代数程序</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></code></a></td>
<td>n维图像处理包</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/odr.html#module-scipy.odr" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.odr</span></code></a></td>
<td>正交距离回归</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></code></a></td>
<td>优化</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></code></a></td>
<td>信号处理</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/sparse.html#module-scipy.sparse" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.sparse</span></code></a></td>
<td>稀疏矩阵</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/spatial.html#module-scipy.spatial" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.spatial</span></code></a></td>
<td>空间数据结果和算法</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></code></a></td>
<td>特殊数学函数</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></code></a></td>
<td>统计</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p>所有的这些子模块都构建在 <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/index.html#module-numpy" title="(在 NumPy v1.12)"><code class="xref py py-mod docutils literal"><span class="pre">numpy</span></code></a> 基础之上, 但是它们之间绝大部分是相互独立的
引入Numpy和Scipy中这些小模块的标准方式如下所示</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>  <span class="c1"># same for other sub-modules</span>
<div class="newline"></div></pre></div>
</div>
<p class="last"><code class="docutils literal"><span class="pre">scipy</span></code> 命名空间中直接包含的函数多是真实的numpy函数
(比如 <code class="docutils literal"><span class="pre">scipy.cos</span> <span class="pre">是</span> <span class="pre">np.cos</span></code>)。因此，一般来讲你的程序中不会用到 <code class="docutils literal"><span class="pre">import</span>
<span class="pre">scipy</span></code> 。</p>
</div>
<div class="section" id="scipy-io">
<h2><a class="toc-backref" href="#id6">1.5.1. 文件输入输出: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.io</span></code></a></a><a class="headerlink" href="#scipy-io" title="永久链接至标题">¶</a></h2>
<ul>
<li><p class="first">载入和保存matlab文件:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">io</span> <span class="k">as</span> <span class="n">spio</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">spio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span> <span class="c1"># savemat expects a dictionary</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">spio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">,</span> <span class="n">struct_as_record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[ 1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
</ul>
<ul>
<li><p class="first">读取图像:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">misc</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;fname.png&#39;</span><span class="p">)</span>    
<div class="newline"></div><span class="go">array(...)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Matplotlib中有一个相似的函数</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;fname.png&#39;</span><span class="p">)</span>    
<div class="newline"></div><span class="go">array(...)</span>
<div class="newline"></div></pre></div>
</div>
</li>
</ul>
<p>参见:</p>
<blockquote>
<div><ul class="simple">
<li>载入文本文件: <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="(在 NumPy v1.12)"><code class="xref py py-func docutils literal"><span class="pre">numpy.loadtxt()</span></code></a>/<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.savetxt.html#numpy.savetxt" title="(在 NumPy v1.12)"><code class="xref py py-func docutils literal"><span class="pre">numpy.savetxt()</span></code></a></li>
<li>格式化载入text/csv文件:
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html#numpy.genfromtxt" title="(在 NumPy v1.12)"><code class="xref py py-func docutils literal"><span class="pre">numpy.genfromtxt()</span></code></a>/<code class="xref py py-func docutils literal"><span class="pre">numpy.recfromcsv()</span></code></li>
<li>高效快速载入numpy指定类型的，二进制格式文件:
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.save.html#numpy.save" title="(在 NumPy v1.12)"><code class="xref py py-func docutils literal"><span class="pre">numpy.save()</span></code></a>/<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html#numpy.load" title="(在 NumPy v1.12)"><code class="xref py py-func docutils literal"><span class="pre">numpy.load()</span></code></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="scipy-special">
<h2><a class="toc-backref" href="#id7">1.5.2. 特殊函数: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></code></a></a><a class="headerlink" href="#scipy-special" title="永久链接至标题">¶</a></h2>
<p>这里的特殊函数指的是超越函数。 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.special</span></code></a> 模块的文档写得很详细，在此
我们仅列出一些常用的特殊函数:</p>
<blockquote>
<div><ul class="simple">
<li>Bessel函数, 比如 <code class="xref py py-func docutils literal"><span class="pre">scipy.special.jn()</span></code> (n阶Bessel函数)</li>
<li>椭圆函数 (Jacobian椭圆函数 <code class="xref py py-func docutils literal"><span class="pre">scipy.special.ellipj()</span></code> )</li>
<li>Gamma函数: <code class="xref py py-func docutils literal"><span class="pre">scipy.special.gamma()</span></code>, 另有
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.gammaln.html#scipy.special.gammaln" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.special.gammaln()</span></code></a> 对数形式给出的精确度更高的Gamma函数。</li>
<li>Erf, 高斯曲线下方的面积: <code class="xref py py-func docutils literal"><span class="pre">scipy.special.erf()</span></code></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="scipy-linalg">
<span id="id2"></span><h2><a class="toc-backref" href="#id8">1.5.3. 线性代数操作: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></code></a></a><a class="headerlink" href="#scipy-linalg" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></code></a> 模块提供了基于BLAS和LAPACK的高效的代数操作方法。</p>
<ul>
<li><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.det.html#scipy.linalg.det" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.linalg.det()</span></code></a> 计算方阵的行列式:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">linalg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">-2.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">0.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div><span class="c">...</span>
<div class="newline"></div><span class="gr">ValueError</span>: <span class="n">expected square matrix</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.inv.html#scipy.linalg.inv" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.linalg.inv()</span></code></a> 计算方阵的逆矩阵:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iarr</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iarr</span>
<div class="newline"></div><span class="go">array([[-2. ,  1. ],</span>
<div class="newline"></div><span class="go">       [ 1.5, -0.5]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">iarr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>如果计算奇异矩阵(其行列式为0)的逆矩阵，函数会抛出 <code class="docutils literal"><span class="pre">LinAlgError</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>  
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div><span class="c">...</span>
<div class="newline"></div><span class="gr">...LinAlgError</span>: <span class="n">singular matrix</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">奇异值分解(SVD):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">uarr</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">vharr</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>奇异值如下所示:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span>    
<div class="newline"></div><span class="go">array([ 14.88982544,   0.45294236,   0.29654967])</span>
<div class="newline"></div></pre></div>
</div>
<p>原始的矩阵可以使用 <code class="docutils literal"><span class="pre">svd</span></code> 的输出结果和 <code class="docutils literal"><span class="pre">np.dot</span></code> 的乘积重新生成:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">svd_mat</span> <span class="o">=</span> <span class="n">uarr</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sarr</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vharr</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">svd_mat</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>SVD常用于统计和信号处理领域。其他的一些标准分解方法(QR, LU, Cholesky, Schur)
在 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></code></a> 中也能够找到。</p>
</li>
</ul>
</div>
<div class="section" id="scipy-fftpack">
<h2><a class="toc-backref" href="#id9">1.5.4. 快速傅里叶变换: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></code></a></a><a class="headerlink" href="#scipy-fftpack" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></code></a> 模块包含了快速傅里叶变换的功能.</div></blockquote>
<p>下面是一个噪声信号的例子:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.02</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">period</span> <span class="o">=</span> <span class="mf">5.</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">time_step</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">period</span> <span class="o">*</span> <span class="n">time_vec</span><span class="p">)</span> <span class="o">+</span> \
<div class="newline"></div><span class="gp">... </span>      <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">time_vec</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>观察者不知道信号的频率，只知道信号的采样间隙 <code class="docutils literal"><span class="pre">sig</span></code>. 信号是来自真实函数的，那么
傅里叶变换是对称的。 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fftfreq.html#scipy.fftpack.fftfreq" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.fftpack.fftfreq()</span></code></a>
函数会生成采样频率，<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fft.html#scipy.fftpack.fft" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.fftpack.fft()</span></code></a> 则用于进行快速傅里叶变化:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">fftpack</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sample_freq</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig_fft</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Because the resulting power is symmetric, only the positive part of the
spectrum needs to be used for finding the frequency:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pidxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sample_freq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">freqs</span> <span class="o">=</span> <span class="n">sample_freq</span><span class="p">[</span><span class="n">pidxs</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sig_fft</span><span class="p">)[</span><span class="n">pidxs</span><span class="p">]</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/fftpack_frequency.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_frequency.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_frequency.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/fftpack_frequency.png"><img alt="../_images/fftpack_frequency.png" src="../_images/fftpack_frequency.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>信号频率可通过如下方式获得:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">power</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">period</span><span class="p">)</span>  <span class="c1"># check that correct freq is found</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>滤去傅里叶变化后的信号中的高频噪声:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig_fft</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sample_freq</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<div class="newline"></div></pre></div>
</div>
<p>去噪后信号可通过如下方式计算：
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.ifft.html#scipy.fftpack.ifft" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.fftpack.ifft()</span></code></a> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">main_sig</span> <span class="o">=</span> <span class="n">fftpack</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">sig_fft</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>结果如下:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.figure.Figure object at 0x...&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_vec</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>    
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_vec</span><span class="p">,</span> <span class="n">main_sig</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>    
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at 0x...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.text.Text object at 0x...&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.text.Text object at 0x...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/fftpack_signals.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_signals.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/fftpack_signals.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/fftpack_signals.png"><img alt="../_images/fftpack_signals.png" src="../_images/fftpack_signals.png" style="width: 308.0px; height: 252.0px;" /></a>
<div class="topic">
<p class="topic-title first"><cite>numpy.fft</cite></p>
<p>Numpy也有一个FFT的子模块 (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.fft.html#module-numpy.fft" title="(在 NumPy v1.12)"><code class="xref py py-mod docutils literal"><span class="pre">numpy.fft</span></code></a>). 但是Scipy中的FFT更为常用，
因其底层实现更为高效</p>
</div>
<div class="topic">
<p class="topic-title first">例子: 寻找自然周期</p>
<p>[<a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder.py">source code</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_00.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_00.pdf">pdf</a>]</p>
<img alt="../_images/periodicity_finder_00.png" src="../_images/periodicity_finder_00.png" />
<p>[<a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder.py">source code</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_01.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/intro/solutions/periodicity_finder_01.pdf">pdf</a>]</p>
<img alt="../_images/periodicity_finder_01.png" src="../_images/periodicity_finder_01.png" />
</div>
<div class="topic">
<p class="topic-title first">例子: 高斯模糊</p>
<p>卷积:</p>
<div class="math">
<p><img src="../_images/math/e14a57d354f7b267ac11bd11402122844b2a4f27.png" alt="f_1(t) = \int dt'\, K(t-t') f_0(t')"/></p>
</div><div class="math">
<p><img src="../_images/math/f9a1f475556b0450791a6e7e1f684130c95ac050.png" alt="\tilde{f}_1(\omega) = \tilde{K}(\omega) \tilde{f}_0(\omega)"/></p>
</div><p>[<a class="reference external" href="../plot_directive/intro/solutions/image_blur.py">source code</a>, <a class="reference external" href="../plot_directive/intro/solutions/image_blur.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/intro/solutions/image_blur.pdf">pdf</a>]</p>
<img alt="../_images/image_blur.png" src="../_images/image_blur.png" />
</div>
<div class="green topic">
<p class="topic-title first">练习: 去除登月图像中的噪点</p>
<a class="reference internal image-reference" href="../_images/moonlanding.png"><img alt="../_images/moonlanding.png" src="../_images/moonlanding.png" style="width: 441.0px; height: 331.8px;" /></a>
<ol class="arabic simple">
<li>如图，moonlanding.png被周期性的噪点所污染。在这个练习中，我们将会使用快速傅里叶变化来进行去噪。</li>
<li>使用 <code class="xref py py-func docutils literal"><span class="pre">pylab.imread()</span></code> 函数读取图像。</li>
<li>使用 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fftpack.html#module-scipy.fftpack" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></code></a> 模块中的2维傅里叶变换函数, 画出图像的频谱。不能可视化频谱？哪里出了问题？</li>
<li>频谱包含高频和低频成分。而噪声包含在高频部分，通过将这些部分的值有选择性的置为0可达到去噪的目的(利用数组切片特性).</li>
<li>使用傅里叶反变换得到图像。</li>
</ol>
</div>
</div>
<div class="section" id="scipy-optimize">
<h2><a class="toc-backref" href="#id10">1.5.5. 优化和拟合: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></code></a></a><a class="headerlink" href="#scipy-optimize" title="永久链接至标题">¶</a></h2>
<p>优化用于求解最小化或者等式一类问题的数值解。</p>
<blockquote>
<div><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></code></a> 模块提供了求解函数最小值，曲线拟合等算法的实现。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">optimize</span>
<div class="newline"></div></pre></div>
</div>
</div></blockquote>
<p><strong>求解标量函数的最小值</strong></p>
<p>定义下面的函数:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>画出其图像:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example1.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example1.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example1.pdf">pdf</a>]</p>
<img alt="../_images/scipy_optimize_example1.png" src="../_images/scipy_optimize_example1.png" />
<p>此函数有一个全局最小值，约为-1.3， 还有一个局部最小值，约为3.8。</p>
<p>一个常用的求解此函数最小值的方法是确定初始点，然后执行梯度下降算法。BFGS算法是一个
很好的适用于此的方法:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin_bfgs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">Optimization terminated successfully.</span>
<div class="newline"></div><span class="go">         Current function value: -7.945823</span>
<div class="newline"></div><span class="go">         Iterations: 5</span>
<div class="newline"></div><span class="go">         Function evaluations: 24</span>
<div class="newline"></div><span class="go">         Gradient evaluations: 8</span>
<div class="newline"></div><span class="go">array([-1.30644003])</span>
<div class="newline"></div></pre></div>
</div>
<p>这个方法的缺陷在于有时候可能会被困在一个局部最小值，而得不到全局的最小值。
这取决与初始点的选取:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin_bfgs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ 3.83746663])</span>
<div class="newline"></div></pre></div>
</div>
<p>如果我们不知道全局最小值的邻近数值，就需要使用那些可以实现全局最优化的算法。比如 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.basinhopping.html#scipy.optimize.basinhopping" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.basinhopping()</span></code></a>
包含一个求解局部最小值的算法和一个为该算法提供随机初始点的函数:</p>
<div class="versionadded">
<p><span class="versionmodified">0.12.0 新版功能: </span>basinhopping was added in version 0.12.0 of Scipy</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize</span><span class="o">.</span><span class="n">basinhopping</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  
<div class="newline"></div><span class="go">                  nfev: 1725</span>
<div class="newline"></div><span class="go"> minimization_failures: 0</span>
<div class="newline"></div><span class="go">                   fun: -7.9458233756152845</span>
<div class="newline"></div><span class="go">                     x: array([-1.30644001])</span>
<div class="newline"></div><span class="go">               message: [&#39;requested number of basinhopping iterations completed successfully&#39;]</span>
<div class="newline"></div><span class="go">                  njev: 575</span>
<div class="newline"></div><span class="go">                   nit: 100</span>
<div class="newline"></div></pre></div>
</div>
<p>另外一个可用的，但不怎么高效的全局最优化算法是
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.brute.html#scipy.optimize.brute" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.brute()</span></code></a> 。在 <code class="docutils literal"><span class="pre">scipy</span></code> 中包含的算法之外，还有许多可以实现全局最优化的算法。
这里使一些拥有相关算法的包OpenOpt, <a class="reference external" href="https://github.com/xuy/pyipopt">IPOPT</a>, <a class="reference external" href="http://esa.github.io/pygmo/">PyGMO</a> and <a class="reference external" href="http://pyevolve.sourceforge.net/">PyEvolve</a>。</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在老版本的 <code class="docutils literal"><span class="pre">scipy</span></code> 中，还包含 <cite>退火</cite> 算法。</p>
</div>
<p>为了找到局部最小值，可以把变量限制在区间``(0, 10)`` 中，
使用 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fminbound.html#scipy.optimize.fminbound" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.fminbound()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xmin_local</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fminbound</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">xmin_local</span>    
<div class="newline"></div><span class="go">3.8374671...</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">寻找函数的最小值在更高级的章节中有提到: <a class="reference internal" href="../advanced/mathematical_optimization/index.html#mathematical-optimization"><span class="std std-ref">Mathematical optimization: finding minima of functions</span></a>.</p>
</div>
<p><strong>寻找标量函数的零点</strong></p>
<p>例如，求解 <img class="math" src="../_images/math/19457fa673fa8d51d62a73cc70bf7e1c9bd0de7c.png" alt="f(x) = 0" style="vertical-align: -7px"/> 的零点, 其中 <img class="math" src="../_images/math/820575a3248a951f90af909f7c19f0c30d7679d6.png" alt="f" style="vertical-align: -6px"/> 是我们在上面用到的函数。
可以使用 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html#scipy.optimize.fsolve" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.fsolve()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># our initial guess is 1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span>
<div class="newline"></div><span class="go">array([ 0.])</span>
<div class="newline"></div></pre></div>
</div>
<p>从上面的图像中我们可以看出函数 <img class="math" src="../_images/math/820575a3248a951f90af909f7c19f0c30d7679d6.png" alt="f" style="vertical-align: -6px"/> 包含两个零点。第二个零点在-2.5附近。
通过调整初始值，我们可以找出精确解:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">root2</span>
<div class="newline"></div><span class="go">array([-2.47948183])</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>曲线拟合</strong></p>
<p>假设我们现在有从函数 <img class="math" src="../_images/math/820575a3248a951f90af909f7c19f0c30d7679d6.png" alt="f" style="vertical-align: -6px"/> 中采样得到的含有一些噪声的数据:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">xdata</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>我们已经知道了函数的形式是 (<img class="math" src="../_images/math/296e00c0b667d4d14bd678e9cccbc1b17235aa41.png" alt="x^2 + \sin(x)" style="vertical-align: -7px"/> ) 但不知道每一项系数的大小。
我们可以使用最小二乘算法来进行曲线拟合得到系数的值。 首先定义需要进行拟合的函数:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>T接着使用 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.curve_fit()</span></code></a> 来求解 <img class="math" src="../_images/math/d54327e6a802a38385738bc7c146cadefa43d3f3.png" alt="a" style="vertical-align: 0px"/> 和 <img class="math" src="../_images/math/a617135e3ef187f34890ed0d4eeb13720c6617a2.png" alt="b" style="vertical-align: 0px"/>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="p">,</span> <span class="n">params_covariance</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<div class="newline"></div><span class="go">array([  0.99667386,  10.17808313])</span>
<div class="newline"></div></pre></div>
</div>
<p>现在我们已经找到了函数 <code class="docutils literal"><span class="pre">f</span></code> 的最小值和零点，并且对采自这个函数的数据进行了曲线拟合的实验。
我们可以把所有的结果呈现在同一张图像上:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example2.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example2.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_example2.pdf">pdf</a>]</p>
<img alt="../_images/scipy_optimize_example2.png" src="../_images/scipy_optimize_example2.png" />
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在 Scipy &gt;= 0.11 的版本中，求解最小值和零点的函数可以通过:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.minimize()</span></code></a>,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.minimize_scalar()</span></code></a>,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.root()</span></code></a>。 并且允许使用 <code class="docutils literal"><span class="pre">method</span></code> 关键字比较不同的算法.</p>
</div>
<p>你可以在 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.optimize</span></code></a> 中找到适用于多维函数的算法.</p>
<div class="green topic">
<p class="topic-title first">练习: 对温度数据进行曲线拟合。</p>
<blockquote>
<div><p>阿拉斯加每月的气温变化都很剧烈, 下面是从一月开始，阿拉斯加每月的温度情况
(单位为摄氏度):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">最大值</span><span class="p">:</span>  <span class="mi">17</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">21</span><span class="p">,</span>  <span class="mi">28</span><span class="p">,</span>  <span class="mi">33</span><span class="p">,</span>  <span class="mi">38</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span>  <span class="mi">37</span><span class="p">,</span>  <span class="mi">31</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">18</span>
<div class="newline"></div><span class="n">最小值</span><span class="p">:</span> <span class="o">-</span><span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span>
<div class="newline"></div></pre></div>
</div>
<ol class="arabic simple">
<li>画出温度图像</li>
<li>定义一个可以描述温度最小值和最大值的函数。
提示: 这个函数的周期为一年。
提示: 包含一个时间偏置量。</li>
<li>使用 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.curve_fit()</span></code></a> 来拟合函数。</li>
<li>画出函数图象。拟合的结果是否合理?  如果不合理，为什么?</li>
<li>在拟合精度范围内，温度最大值和最小值的时间偏置量是否一样?</li>
</ol>
</div></blockquote>
</div>
<div class="green topic">
<p class="topic-title first">联系: 2-D 最小值求解</p>
<blockquote>
<div><p>[<a class="reference external" href="../plot_directive/pyplots/scipy_optimize_sixhump.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_sixhump.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_optimize_sixhump.pdf">pdf</a>]</p>
<img alt="../_images/scipy_optimize_sixhump.png" src="../_images/scipy_optimize_sixhump.png" />
<p>驼峰函数</p>
<div class="math">
<p><img src="../_images/math/4a3708a8dd001c3d5d6c763fb8e3013d8adf116a.png" alt="f(x, y) = (4 - 2.1x^2 + \frac{x^4}{3})x^2 + xy + (4y^2 - 4)y^2"/></p>
</div><p>有多个全局和局部最小值。现在需要寻找此函数的全局最小值。</p>
<p>提示:</p>
<blockquote>
<div><ul class="simple">
<li>限制变量范围 <img class="math" src="../_images/math/d5f5ee74e96a8051941d138a72f42da3dda3c6c8.png" alt="-2 &lt; x &lt; 2" style="vertical-align: -1px"/> ， <img class="math" src="../_images/math/ebcd47e8ca7d3c2cbaa9030f558fe86a4c116d57.png" alt="-1 &lt; y &lt; 1" style="vertical-align: -6px"/>。</li>
<li>使用 <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="(在 NumPy v1.12)"><code class="xref py py-func docutils literal"><span class="pre">numpy.meshgrid()</span></code></a> 和 <code class="xref py py-func docutils literal"><span class="pre">pylab.imshow()</span></code> 目测最小值所在区域。</li>
<li>使用 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_bfgs.html#scipy.optimize.fmin_bfgs" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.optimize.fmin_bfgs()</span></code></a> 或者其他的用于可以求解多维函数最小值的算法</li>
</ul>
</div></blockquote>
<p>函数有多少个全局最小值点，其对应的函数值是多少？如果初始点为 <img class="math" src="../_images/math/fdcfc69b5b88be8603c18edf8ebedeeee5323429.png" alt="(x, y) = (0, 0)" style="vertical-align: -7px"/> 会怎么样?</p>
</div></blockquote>
</div>
<p>更多的例子:ref:<cite>summary_exercise_optimize</cite> 。</p>
</div>
<div class="section" id="scipy-stats">
<h2><a class="toc-backref" href="#id11">1.5.6. 统计和随机数: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></code></a></a><a class="headerlink" href="#scipy-stats" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.stats</span></code></a> 包含一些统计和随机过程相关的工具。在 <code class="xref py py-mod docutils literal"><span class="pre">numpy.random</span></code>
中可以找到生成多种随机过程的随机数生成器。</div></blockquote>
<div class="section" id="id3">
<h3>1.5.6.1. 直方图和概率密度函数<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>给出随机过程的一系列观察点，它们的直方图即为随机过程概率密度函数的一个估计:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span>
<div class="newline"></div><span class="go">array([-4, -3, -2, -1,  0,  1,  2,  3,  4])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">histogram</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span>
<div class="newline"></div><span class="go">array([-3.5, -2.5, -1.5, -0.5,  0.5,  1.5,  2.5,  3.5])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>  <span class="c1"># norm is a distribution</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">histogram</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/normal_distribution.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/normal_distribution.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/normal_distribution.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/normal_distribution.png"><img alt="../_images/normal_distribution.png" src="../_images/normal_distribution.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>如果我们事先已经知道所要处理的随机过程属于某一个随机过程族(比如正态过程)，可以采用最大似然估计来
得到相关参数的值。下面是估计正态过程来拟合观察点的例子:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span>     
<div class="newline"></div><span class="go">0.0314345570...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">std</span>     
<div class="newline"></div><span class="go">0.9778613090...</span>
<div class="newline"></div></pre></div>
</div>
<div class="green topic">
<p class="topic-title first">练习: 概率分布</p>
<p>从形状参数为1的Gamma分布中取出1000个随机数值，画出它们的直方图。你能在其上画出原分布的
概率密度函数图像吗(它们应该是相似的)？</p>
<p>特别地: 你能根据这些数据点得出Gamma分布的形状参数值吗(使用 <code class="docutils literal"><span class="pre">fit</span></code> 方法)？</p>
</div>
</div>
<div class="section" id="id4">
<h3>1.5.6.2. 百分位数<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>中位数:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>     
<div class="newline"></div><span class="go">0.04041769593...</span>
<div class="newline"></div></pre></div>
</div>
<p>也叫第50百分位数:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>     
<div class="newline"></div><span class="go">0.0404176959...</span>
<div class="newline"></div></pre></div>
</div>
<p>相似的，我们可以计算第90百分位数:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>     
<div class="newline"></div><span class="go">1.3185699120...</span>
<div class="newline"></div></pre></div>
</div>
<p>百分位数是累计概率分布函数的一个估计。</p>
</div>
<div class="section" id="id5">
<h3>1.5.6.3. 统计检验<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>统计检验的结果常用作一个决策指标。例如，如果我们有两组观察点，它们都来自高斯过程，我们可以使用
<a class="reference external" href="https://en.wikipedia.org/wiki/Student%27s_t-test">T-检验</a> 来判断两组观察点是都显著不同:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>   
<div class="newline"></div><span class="go">(array(-3.177574054...), 0.0019370639...)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p>输出结果由以下部分组成:</p>
<ul class="simple">
<li>T统计量的值: it is a number the sign of which is
proportional to the difference between the two random processes and
the magnitude is related to the significance of this difference.</li>
<li><em>p 值</em>: 两个过程相同的概率。如果其值接近1，那么两个过程几乎可以确定是相同的，如果其值接近0，</li>
</ul>
<blockquote class="last">
<div>那么它们很可能拥有不同的均值。</div></blockquote>
</div>
</div>
</div>
<div class="section" id="scipy-interpolate">
<h2><a class="toc-backref" href="#id12">1.5.7. 插值计算: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></code></a></a><a class="headerlink" href="#scipy-interpolate" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.interpolate</span></code></a> 模块在拟合实验数据并估计未知点数值方面非常有用。
这个模块是基于来自 <a class="reference external" href="http://www.netlib.org">netlib</a> 项目的 <a class="reference external" href="http://www.netlib.org/dierckx/index.html">FITPACK Fortran subroutines</a> 。</div></blockquote>
<p>产生一个近似正弦函数的一系列实验数据:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>   &gt;&gt;&gt; measured_time = np.linspace(0, 1, 10)
<div class="newline"></div>   &gt;&gt;&gt; noise = (np.random.random(10)*2 - 1) * 1e-1
<div class="newline"></div>   &gt;&gt;&gt; measures = np.sin(2 * np.pi * measured_time) + noise
<div class="newline"></div>
<div class="newline"></div>:class:`scipy.interpolate.interp1d` 类可以创建一个线性插值函数::
<div class="newline"></div>
<div class="newline"></div>   &gt;&gt;&gt; from scipy.interpolate import interp1d
<div class="newline"></div>   &gt;&gt;&gt; linear_interp = interp1d(measured_time, measures)
<div class="newline"></div>
<div class="newline"></div>:obj:`scipy.interpolate.linear_interp` 实例可以在需要的时候获取某些值::
<div class="newline"></div>
<div class="newline"></div>   &gt;&gt;&gt; computed_time = np.linspace(0, 1, 50)
<div class="newline"></div>   &gt;&gt;&gt; linear_results = linear_interp(computed_time)
<div class="newline"></div></pre></div>
</div>
<p>三次插值函数可通过 <code class="docutils literal"><span class="pre">kind</span></code> 关键字参数得到:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cubic_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">measured_time</span><span class="p">,</span> <span class="n">measures</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cubic_results</span> <span class="o">=</span> <span class="n">cubic_interp</span><span class="p">(</span><span class="n">computed_time</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>所有结果呈现在如下的Matplotlib图像中:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/scipy_interpolation.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_interpolation.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/scipy_interpolation.pdf">pdf</a>]</p>
<img alt="../_images/scipy_interpolation.png" src="../_images/scipy_interpolation.png" />
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp2d.html#scipy.interpolate.interp2d" title="(在 SciPy v0.19.0)"><code class="xref py py-class docutils literal"><span class="pre">scipy.interpolate.interp2d</span></code></a> 和
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html#scipy.interpolate.interp1d" title="(在 SciPy v0.19.0)"><code class="xref py py-class docutils literal"><span class="pre">scipy.interpolate.interp1d</span></code></a> 较为相似, 但是其适用对象为二维数组。
获取样条插值的使用实例 <a class="reference internal" href="summary-exercises/stats-interpolate.html#summary-exercise-stat-interp"><span class="std std-ref">Maximum wind speed prediction at the Sprogø station</span></a> 。</p>
</div>
<div class="section" id="numerical-integration-scipy-integrate">
<h2><a class="toc-backref" href="#id13">1.5.8. Numerical integration: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></code></a></a><a class="headerlink" href="#numerical-integration-scipy-integrate" title="永久链接至标题">¶</a></h2>
<p>The most generic integration routine is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.quad()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">quad</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">res</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Others integration schemes are available with <code class="docutils literal"><span class="pre">fixed_quad</span></code>,
<code class="docutils literal"><span class="pre">quadrature</span></code>, <code class="docutils literal"><span class="pre">romberg</span></code>.</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></code></a> also features routines for integrating Ordinary
Differential Equations (ODE). In particular, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.odeint()</span></code></a>
is a general-purpose integrator using LSODA (Livermore Solver for
Ordinary Differential equations with Automatic method switching
for stiff and non-stiff problems), see the <a class="reference external" href="http://people.sc.fsu.edu/~jburkardt/f77_src/odepack/odepack.html">ODEPACK Fortran library</a>
for more details.</p>
<p><code class="docutils literal"><span class="pre">odeint</span></code> solves first-order ODE systems of the form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dy</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="o">..</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span><span class="o">...</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>As an introduction, let us solve the ODE <img class="math" src="../_images/math/b0395df39e1e94a0674a6c1172ad24435fd04df9.png" alt="\frac{dy}{dt} = -2 y" style="vertical-align: -10px"/> between
<img class="math" src="../_images/math/bcea244e49240f402da40c281405130c38a0a53d.png" alt="t = 0 \dots 4" style="vertical-align: -1px"/>, with the  initial condition <img class="math" src="../_images/math/62e850e67fa99b97053b8755092d1e81d9635734.png" alt="y(t=0) = 1" style="vertical-align: -7px"/>.
First the function computing the derivative of the position needs to be defined:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">calc_derivative</span><span class="p">(</span><span class="n">ypos</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">counter_arr</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">counter_arr</span> <span class="o">+=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ypos</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div></pre></div>
</div>
<p>An extra argument <code class="docutils literal"><span class="pre">counter_arr</span></code> has been added to illustrate that the
function may be called several times for a single time step, until solver
convergence. The counter array is defined as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">counter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>The trajectory will now be computed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">odeint</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yvec</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">calc_derivative</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">time_vec</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>                    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">counter</span><span class="p">,),</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Thus the derivative function has been called more than 40 times
(which was the number of time steps):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">counter</span>
<div class="newline"></div><span class="go">array([129], dtype=uint16)</span>
<div class="newline"></div></pre></div>
</div>
<p>and the cumulative number of iterations for each of the 10 first time steps
can be obtained by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;nfe&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([31, 35, 43, 49, 53, 57, 59, 63, 65, 69], dtype=int32)</span>
<div class="newline"></div></pre></div>
</div>
<p>Note that the solver requires more iterations for the first time step.
The solution <code class="docutils literal"><span class="pre">yvec</span></code> for the trajectory can now be plotted:</p>
<blockquote>
<div><p>[<a class="reference external" href="../plot_directive/pyplots/odeint_introduction.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_introduction.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_introduction.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/odeint_introduction.png"><img alt="../_images/odeint_introduction.png" src="../_images/odeint_introduction.png" style="width: 308.0px; height: 252.0px;" /></a>
</div></blockquote>
<p>Another example with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.odeint()</span></code></a> will be a damped
spring-mass oscillator (2nd order oscillator).
The position of a mass attached to a spring obeys the 2nd order <strong>ODE</strong>
<img class="math" src="../_images/math/c5d2120be907c859b0613881cc2cbe7764734ea7.png" alt="y'' + 2 \varepsilon \omega_0  y' + \omega_0^2 y = 0" style="vertical-align: -7px"/> with
<img class="math" src="../_images/math/820c8b9eca6eb5522e96872daf92cf80c8836b74.png" alt="\omega_0^2 = k/m" style="vertical-align: -7px"/> with <img class="math" src="../_images/math/c8ff6dc362a9a07153582909d5a26898fae59569.png" alt="k" style="vertical-align: 0px"/> the spring constant, <img class="math" src="../_images/math/2a6f9b0b4119433a3eae475d163e0694af1ca408.png" alt="m" style="vertical-align: 0px"/> the mass
and <img class="math" src="../_images/math/7e4407fe4473fd3e5ed71fefe275ba1d63e614f6.png" alt="\varepsilon = c/(2 m \omega_0)" style="vertical-align: -7px"/> with <img class="math" src="../_images/math/e76342811b06d3703a2794f9744a8df6906f358f.png" alt="c" style="vertical-align: 0px"/> the damping coefficient.
For this example, we choose the parameters as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mass</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># kg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">kspring</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># N/m</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cviscous</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># N s/m</span>
<div class="newline"></div></pre></div>
</div>
<p>so the system will be underdamped, because:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="n">cviscous</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kspring</span><span class="o">/</span><span class="n">mass</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">&lt;</span> <span class="mi">1</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>For the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.integrate.odeint()</span></code></a> solver the 2nd order equation
needs to be transformed in a system of two first-order equations for
the vector <img class="math" src="../_images/math/579a0ec5dffca0ed7e017f88646bd15a2f58b1b9.png" alt="Y = (y, y')" style="vertical-align: -7px"/>.  It will be convenient to define
<img class="math" src="../_images/math/1e1f051212fdbcc22361c37d5026aeab7fa4433d.png" alt="\nu = 2 \varepsilon * \omega_0 = c / m" style="vertical-align: -7px"/> and <img class="math" src="../_images/math/f56f8717ca18d7e950c2195523921386af5602f7.png" alt="\Omega = \omega_0^2 = k/m" style="vertical-align: -7px"/>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nu_coef</span> <span class="o">=</span> <span class="n">cviscous</span> <span class="o">/</span> <span class="n">mass</span>  <span class="c1"># nu</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">om_coef</span> <span class="o">=</span> <span class="n">kspring</span> <span class="o">/</span> <span class="n">mass</span>  <span class="c1"># Omega</span>
<div class="newline"></div></pre></div>
</div>
<p>Thus the function will calculate the velocity and acceleration by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">calc_deri</span><span class="p">(</span><span class="n">yvec</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">om</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">yvec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">nu</span> <span class="o">*</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">om</span> <span class="o">*</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">time_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yinit</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">yarr</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">calc_deri</span><span class="p">,</span> <span class="n">yinit</span><span class="p">,</span> <span class="n">time_vec</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">nu_coef</span><span class="p">,</span> <span class="n">om_coef</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<p>The final position and velocity are shown on the following Matplotlib figure:</p>
<p>[<a class="reference external" href="../plot_directive/pyplots/odeint_damped_spring_mass.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_damped_spring_mass.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/odeint_damped_spring_mass.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/odeint_damped_spring_mass.png"><img alt="../_images/odeint_damped_spring_mass.png" src="../_images/odeint_damped_spring_mass.png" style="width: 308.0px; height: 252.0px;" /></a>
<p>These two examples were only Ordinary Differential Equations (ODE).
However, there is no Partial Differential Equations (PDE) solver in Scipy.
Some Python packages for solving PDE&#8217;s are available, such as <a class="reference external" href="http://www.ctcms.nist.gov/fipy/">fipy</a> or <a class="reference external" href="http://sfepy.org/doc/">SfePy</a>.</p>
</div>
<div class="section" id="scipy-signal">
<h2><a class="toc-backref" href="#id14">1.5.9. 信号处理: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></code></a></a><a class="headerlink" href="#scipy-signal" title="永久链接至标题">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">signal</span>
<div class="newline"></div></pre></div>
</div>
<ul>
<li><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.detrend.html#scipy.signal.detrend" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.detrend()</span></code></a>: 去除信号中的线形趋势:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/demo_detrend.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/demo_detrend.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/demo_detrend.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/demo_detrend.png"><img alt="../_images/demo_detrend.png" src="../_images/demo_detrend.png" style="width: 308.0px; height: 252.0px;" /></a>
</li>
<li><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.resample()</span></code></a>: 使用FFT对信号重采样:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../plot_directive/pyplots/demo_resample.py">source code</a>, <a class="reference external" href="../plot_directive/pyplots/demo_resample.hires.png">hires.png</a>, <a class="reference external" href="../plot_directive/pyplots/demo_resample.pdf">pdf</a>]</p>
<a class="reference internal image-reference" href="../_images/demo_resample.png"><img alt="../_images/demo_resample.png" src="../_images/demo_resample.png" style="width: 308.0px; height: 252.0px;" /></a>
</li>
<li><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></code></a> 提供许多的窗函数: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.hamming.html#scipy.signal.hamming" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.hamming()</span></code></a>,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.bartlett.html#scipy.signal.bartlett" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.bartlett()</span></code></a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.blackman.html#scipy.signal.blackman" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.blackman()</span></code></a>...</p>
</li>
<li><p class="first"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></code></a> 也提供了滤波的相关函数 (中值滤波器 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.medfilt.html#scipy.signal.medfilt" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.medfilt()</span></code></a>,
维纳滤波器 <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.wiener.html#scipy.signal.wiener" title="(在 SciPy v0.19.0)"><code class="xref py py-func docutils literal"><span class="pre">scipy.signal.wiener()</span></code></a>)， 详情参见随后的图像一节。</p>
</li>
</ul>
</div>
<div class="section" id="scipy-ndimage">
<h2><a class="toc-backref" href="#id15">1.5.10. 图像处理: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></code></a></a><a class="headerlink" href="#scipy-ndimage" title="永久链接至标题">¶</a></h2>
<p>The submodule dedicated to image processing in scipy is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<div class="newline"></div></pre></div>
</div>
<p>Image processing routines may be sorted according to the category of
processing they perform.</p>
<div class="section" id="geometrical-transformations-on-images">
<h3>1.5.10.1. Geometrical transformations on images<a class="headerlink" href="#geometrical-transformations-on-images" title="永久链接至标题">¶</a></h3>
<p>Changing orientation, resolution, ..</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_face2</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_face</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(1536, 2048)</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/face_transforms.png"><img alt="../_images/face_transforms.png" src="../_images/face_transforms.png" style="width: 1499.4px; height: 254.1px;" /></a>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">151</span><span class="p">)</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.axes._subplots.AxesSubplot object at 0x...&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">shifted_face</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>    
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">(-0.5, 1023.5, 767.5, -0.5)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># etc.</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="image-filtering">
<h3>1.5.10.2. Image filtering<a class="headerlink" href="#image-filtering" title="永久链接至标题">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">misc</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[:</span><span class="mi">512</span><span class="p">,</span> <span class="o">-</span><span class="mi">512</span><span class="p">:]</span>  <span class="c1"># crop out square on right</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_face</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">face</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_face</span> <span class="o">+=</span> <span class="n">face</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">median_face</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">signal</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">wiener_face</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">wiener</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/filtered_face.png"><img alt="../_images/filtered_face.png" src="../_images/filtered_face.png" style="width: 956.8px; height: 240.0px;" /></a>
</div>
<p>Many other filters in <code class="xref py py-mod docutils literal"><span class="pre">scipy.ndimage.filters</span></code> and <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(在 SciPy v0.19.0)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.signal</span></code></a>
can be applied to images.</p>
<div class="green topic">
<p class="topic-title first">Exercise</p>
<blockquote>
<div>Compare histograms for the different filtered images.</div></blockquote>
</div>
</div>
<div class="section" id="mathematical-morphology">
<h3>1.5.10.3. Mathematical morphology<a class="headerlink" href="#mathematical-morphology" title="永久链接至标题">¶</a></h3>
<p>Mathematical morphology is a mathematical theory that stems from set
theory. It characterizes and transforms geometrical structures. Binary
(black and white) images, in particular, can be transformed using this
theory: the sets to be transformed are the sets of neighboring
non-zero-valued pixels. The theory was also extended to gray-valued images.</p>
<img alt="../_images/morpho_mat1.png" class="align-center" src="../_images/morpho_mat1.png" />
<p>Elementary mathematical-morphology operations use a <em>structuring element</em>
in order to modify other geometrical structures.</p>
<p>Let us first generate a structuring element</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> 
<div class="newline"></div><span class="go">array([[False, True, False],</span>
<div class="newline"></div><span class="go">       [...True, True, True],</span>
<div class="newline"></div><span class="go">       [False, True, False]], dtype=bool)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 1, 0],</span>
<div class="newline"></div><span class="go">       [1, 1, 1],</span>
<div class="newline"></div><span class="go">       [0, 1, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<ul>
<li><p class="first"><strong>Erosion</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Erosion removes objects smaller than the structure</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Dilation</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Opening</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 1]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening removes small objects</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening can also smooth corners</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first"><strong>Closing:</strong> <code class="docutils literal"><span class="pre">ndimage.binary_closing</span></code></p>
</li>
</ul>
<div class="green topic">
<p class="topic-title first">Exercise</p>
<blockquote>
<div>Check that opening amounts to eroding, then dilating.</div></blockquote>
</div>
<p>An opening operation removes small structures, while a closing operation
fills small holes. Such operations can therefore be used to &#8220;clean&#8221; an
image.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mf">0.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">opened_mask</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">closed_mask</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">opened_mask</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/morpho.png"><img alt="../_images/morpho.png" src="../_images/morpho.png" style="width: 866.25px; height: 225.0px;" /></a>
</div>
<div class="green topic">
<p class="topic-title first">Exercise</p>
<blockquote>
<div>Check that the area of the reconstructed square is smaller
than the area of the initial square. (The opposite would occur if the
closing step was performed <em>before</em> the opening).</div></blockquote>
</div>
<p>For <em>gray-valued</em> images, eroding (resp. dilating) amounts to replacing
a pixel by the minimal (resp. maximal) value among pixels covered by the
structuring element centered on the pixel of interest.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 1, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 2, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 3, 2, 2, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="measurements-on-images">
<h3>1.5.10.4. Measurements on images<a class="headerlink" href="#measurements-on-images" title="永久链接至标题">¶</a></h3>
<p>Let us first generate a nice synthetic binary image.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">&gt;</span> <span class="mi">1</span>
<div class="newline"></div></pre></div>
</div>
<p>Now we look for various information about the objects in the image:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">nb</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">nb</span>
<div class="newline"></div><span class="go">8</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span>
<div class="newline"></div><span class="go">array([ 190.,   45.,  424.,  278.,  459.,  190.,  549.,  424.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span>
<div class="newline"></div><span class="go">array([  1.80238238,   1.13527605,   5.51954079,   2.49611818,</span>
<div class="newline"></div><span class="go">         6.71673619,   1.80238238,  16.76547217,   5.51954079])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[(slice(30L, 48L, None), slice(30L, 48L, None))]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">sl</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>   
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/measures.png"><img alt="../_images/measures.png" src="../_images/measures.png" style="width: 910.4px; height: 312.8px;" /></a>
</div>
<p>See the summary exercise on <a class="reference internal" href="summary-exercises/image-processing.html#summary-exercise-image-processing"><span class="std std-ref">Image processing application: counting bubbles and unmolten grains</span></a> for a more
advanced example.</p>
</div>
</div>
<div class="section" id="summary-exercises-on-scientific-computing">
<h2><a class="toc-backref" href="#id16">1.5.11. Summary exercises on scientific computing</a><a class="headerlink" href="#summary-exercises-on-scientific-computing" title="永久链接至标题">¶</a></h2>
<p>The summary exercises use mainly Numpy, Scipy and Matplotlib. They provide some
real-life examples of scientific computing with Python. Now that the basics of
working with Numpy and Scipy have been introduced, the interested user is
invited to try these exercises.</p>
<p><strong>Exercises:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/stats-interpolate.html">1.5.11.1. Maximum wind speed prediction at the Sprogø station</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/optimize-fit.html">1.5.11.2. Non linear least squares curve fitting: application to point extraction in topographical lidar data</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/image-processing.html">1.5.11.3. Image processing application: counting bubbles and unmolten grains</a></li>
</ul>
</div>
<p><strong>Proposed solutions:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/answers_image_processing.html">1.5.11.4. Example of solution for the image processing exercise: unmolten grains in glass</a></li>
</ul>
</div>
<p><div style="clear: both"></div></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
	<div class="sidebartoc">
  <h3><a href="../index.html">內容目录</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.5. Scipy : 高性能科学计算</a><ul>
<li><a class="reference internal" href="#scipy-io">1.5.1. 文件输入输出: <code class="docutils literal"><span class="pre">scipy.io</span></code></a></li>
<li><a class="reference internal" href="#scipy-special">1.5.2. 特殊函数: <code class="docutils literal"><span class="pre">scipy.special</span></code></a></li>
<li><a class="reference internal" href="#scipy-linalg">1.5.3. 线性代数操作: <code class="docutils literal"><span class="pre">scipy.linalg</span></code></a></li>
<li><a class="reference internal" href="#scipy-fftpack">1.5.4. 快速傅里叶变换: <code class="docutils literal"><span class="pre">scipy.fftpack</span></code></a></li>
<li><a class="reference internal" href="#scipy-optimize">1.5.5. 优化和拟合: <code class="docutils literal"><span class="pre">scipy.optimize</span></code></a></li>
<li><a class="reference internal" href="#scipy-stats">1.5.6. 统计和随机数: <code class="docutils literal"><span class="pre">scipy.stats</span></code></a><ul>
<li><a class="reference internal" href="#id3">1.5.6.1. 直方图和概率密度函数</a></li>
<li><a class="reference internal" href="#id4">1.5.6.2. 百分位数</a></li>
<li><a class="reference internal" href="#id5">1.5.6.3. 统计检验</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scipy-interpolate">1.5.7. 插值计算: <code class="docutils literal"><span class="pre">scipy.interpolate</span></code></a></li>
<li><a class="reference internal" href="#numerical-integration-scipy-integrate">1.5.8. Numerical integration: <code class="docutils literal"><span class="pre">scipy.integrate</span></code></a></li>
<li><a class="reference internal" href="#scipy-signal">1.5.9. 信号处理: <code class="docutils literal"><span class="pre">scipy.signal</span></code></a></li>
<li><a class="reference internal" href="#scipy-ndimage">1.5.10. 图像处理: <code class="docutils literal"><span class="pre">scipy.ndimage</span></code></a><ul>
<li><a class="reference internal" href="#geometrical-transformations-on-images">1.5.10.1. Geometrical transformations on images</a></li>
<li><a class="reference internal" href="#image-filtering">1.5.10.2. Image filtering</a></li>
<li><a class="reference internal" href="#mathematical-morphology">1.5.10.3. Mathematical morphology</a></li>
<li><a class="reference internal" href="#measurements-on-images">1.5.10.4. Measurements on images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary-exercises-on-scientific-computing">1.5.11. Summary exercises on scientific computing</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</div>



    <div class="script_container">
    <script>
    (function() {
	var cx = '004523248466141510607:hgv2yimrahw';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
	    '//cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
    })();
    </script>
    <gcse:search></gcse:search>
    </div>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.5.11.1. Maximum wind speed prediction at the Sprogø station"
             >下一页</a></li>
        <li class="right" >
          <a href="matplotlib/matplotlib.html" title="1.4. Matplotlib: 绘图"
             >上一页</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Scipy lecture notes</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >1. 基础教程</a> &#187;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>
    <li class="right edit_on_github"><a href="https://github.com/jayleicn/scipy-lecture-notes-zh-CN/edit/master/intro/scipy.rst">Edit
    <span class="tooltip">
	Improve this page:<br/>Translate/Improve it on Github.
    </span>
    </a>
    </li>

      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016.
      由 <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6 创建。
    </div>
  </body>
</html>